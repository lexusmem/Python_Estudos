{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">{% if salvado %}Atualizar Salvado{% else %}Adicionar Salvado{% endif %}</h2>
<div class="card p-4 shadow-sm">
    <form method="POST">
        {% if not salvado %}
        <div class="mb-3">
            <label class="form-label">Sinistro</label>
            <input type="text" class="form-control" name="sinistro" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Placa</label>
            <input type="text" class="form-control" name="placa" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Modelo</label>
            <input type="text" class="form-control" name="modelo">
        </div>
        <div class="mb-3">
            <label class="form-label">Data Remoção</label>
            <input type="date" class="form-control" name="data_remocao">
        </div>
        <div class="mb-3">
            <label class="form-label">Status</label>
            <select class="form-select" name="status">
                {% for status in status_opcoes %}
                <option value="{{ status }}">{{ status }}</option>
                {% endfor %}
            </select>
        </div>
        {% else %}
        <p class="mb-3"><strong>Sinistro:</strong> {{ salvado[1] }} | <strong>Placa:</strong> {{ salvado[2] }} |
            <strong>Modelo:</strong> {{ salvado[3] }}</p>
        <div class="mb-3">
            <label class="form-label">Status</label>
            <select class="form-select" name="status">
                {% for status in status_opcoes %}
                <option value="{{ status }}" {% if salvado[4]==status %}selected{% endif %}>{{ status }}</option>
                {% endfor %}
            </select>
        </div>

        {% if salvado[4] == 'Transferência Concluída' or request.form.status == 'Transferência Concluída' %}
        <div class="mb-3">
            <label class="form-label">Data Transferência Seguradora</label>
            <input type="date" class="form-control" name="data_transferencia_seguradora">
        </div>
        {% endif %}
        {% if salvado[4] == 'Vistorias Concluídas' or request.form.status == 'Vistorias Concluídas' %}
        <div class="mb-3">
            <label class="form-label">Data 1ª Vistoria</label>
            <input type="date" class="form-control" name="data_vistoria1">
        </div>
        <div class="mb-3">
            <label class="form-label">Data 2ª Vistoria</label>
            <input type="date" class="form-control" name="data_vistoria2">
        </div>
        {% endif %}
        {% if salvado[4] == 'Custo Definido' or request.form.status == 'Custo Definido' %}
        <div class="mb-3">
            <label class="form-label">Custo</label>
            <input type="number" step="0.01" class="form-control" name="custo">
        </div>
        {% endif %}
        {% if salvado[4] == 'Vendido' or request.form.status == 'Vendido' %}
        <div class="mb-3">
            <label class="form-label">Data Leilão</label>
            <input type="date" class="form-control" name="data_leilao">
        </div>
        <div class="mb-3">
            <label class="form-label">Valor Arremate</label>
            <input type="number" step="0.01" class="form-control" name="valor_arremate">
        </div>
        <div class="mb-3">
            <label class="form-label">Comprador</label>
            <input type="text" class="form-control" name="comprador">
        </div>
        {% endif %}
        {% if salvado[4] == 'Transferência Finalizada' or request.form.status == 'Transferência Finalizada' %}
        <div class="mb-3">
            <label class="form-label">Data Transferência Comprador</label>
            <input type="date" class="form-control" name="data_transferencia_comprador">
        </div>
        {% endif %}
        {% endif %}
        <button type="submit" class="btn btn-primary">Salvar</button>
    </form>
</div>
{% endblock %}